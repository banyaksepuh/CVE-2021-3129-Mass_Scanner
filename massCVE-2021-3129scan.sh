#!/bin/bash
#recode from massgitscan.sh github.com/adelittle
#CVE-2021-3129 Scanner
# Colors
cRojo=`tput setaf 1`
cVerde=`tput setaf 2`
cAmarillo=`tput setaf 3`
cAzul=`tput setaf 4`

# Effects
cBold=`tput bold`
cNormal=`tput sgr0` #No color, No bold

LISTS=$1

echo "================================ Mass Scanner for ${cBold}${cAmarillo}CVE-2021-3129${cNormal} ==================================="
echo " ███╗   ███╗ █████╗ ███████╗███████╗    ███████╗ ██████╗ █████╗ ███╗   ██╗███╗   ██╗███████╗██████╗  "
echo " ████╗ ████║██╔══██╗██╔════╝██╔════╝    ██╔════╝██╔════╝██╔══██╗████╗  ██║████╗  ██║██╔════╝██╔══██╗ "
echo " ██╔████╔██║███████║███████╗███████╗    ███████╗██║     ███████║██╔██╗ ██║██╔██╗ ██║█████╗  ██████╔╝ "
echo " ██║╚██╔╝██║██╔══██║╚════██║╚════██║    ╚════██║██║     ██╔══██║██║╚██╗██║██║╚██╗██║██╔══╝  ██╔══██╗ "
echo " ██║ ╚═╝ ██║██║  ██║███████║███████║    ███████║╚██████╗██║  ██║██║ ╚████║██║ ╚████║███████╗██║  ██║ "
echo " ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝    ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝ "
echo "====================================== ${cBold}By ${cBold}${cRojo}Sultan Rizky${cNormal} ============================================"
                                                                                               
if [[ ! -f ${LISTS} ]]; then
        echo "ERROR: ${LISTS} not found"
        echo "usage: bash $0 list.txt"  
        exit
fi
  
for SITE in $(cat $LISTS);
do
  
    if [[ $(curl --connect-timeout 3 --max-time 15 -kLs "${SITE}/_ignition/execute-solution" ) =~ 'The GET method is not supported for this route. Supported methods: POST.' ]]; then
                echo "[+] VULN: ${SITE}"
        else :
        fi
          
done 
